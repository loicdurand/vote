{% extends 'base.html.twig' %}

{% block title %}Interface de vote
{% endblock %}

{% block body %}
	{# Fil d'arianne #}
	<nav role="navigation" class="fr-breadcrumb" aria-label="vous êtes ici :">
		<button type="button" class="fr-breadcrumb__button" aria-expanded="false" aria-controls="breadcrumb">Voir le fil d&#39;arianne</button>

		<div class="fr-collapse" id="breadcrumb">
			<ol class="fr-breadcrumb__list">
				<li>
					<a class="fr-breadcrumb__link" id="segment-0" href="{{ path('app_index') }}">Accueil</a>
				</li>
				<li>
					<a class="fr-breadcrumb__link" id="segment-1" aria-current="page" href="#">Interface de vote</a>
				</li>
			</ol>
		</div>
	</nav>
	{# Fin fil d'arianne #}

	<main>

		<div class="fr-stepper fr-mt-4w">
			<h2 class="fr-stepper__title">
				Confirmation de vote
				<span class="fr-stepper__state">Étape 3 sur 3</span>
			</h2>
			<div class="fr-stepper__steps" data-fr-current-step="3" data-fr-steps="3"></div>
		</div>

		<h3 class="fr-mt-6w">
			Votre vote a bien été enregistré!
		</h3>


		<div class="fr-grid-row fr-grid-row--gutters fr-mt-4w">

			{% if election is not null %}

				<div class="fr-col-sm-12 fr-col-md-5 fr-col-lg-5 fr-col-xl-4 custom-card-container">

					<h3 class="fr-h4 center">Caractéristiques</h3>

					<div class="fr-tile fr-enlarge-link" id="tile-4">
						<div class="fr-tile__body">
							<div class="fr-tile__content">
								<h3 class="fr-tile__title">
									{{ election.title }}
								</h3>
								<p class="fr-tile__desc">{{ election.explaination }}</p>
								<p class="fr-tile__detail">
									Créée par&nbsp;
									{{ election.user.title }}

									<ul class="fr-tags-group">
										{% for grp in election.groupesConcernes %}
											<li>
												<p class="fr-tag fr-tag--défaut" id="tag-group-0">{{ grp.shortName }}</p>
											</li>
										{% endfor %}
									</ul>

								</p>

							</div>
							<!-- fin .fr-tile__content -->
						</div>
						<!-- fin .fr-tile__body -->

						<div class="fr-tile__header">
							<div class="fr-tile__pictogram">
								<svg aria-hidden="true" class="fr-artwork" viewbox="0 0 80 80" width="80px" height="80px">
									<use class="fr-artwork-decorative" href="{{ asset('artwork/pictograms/buildings/city-hall.svg') }}#artwork-decorative"></use>
									<use class="fr-artwork-minor" href="{{ asset('artwork/pictograms/buildings/city-hall.svg') }}#artwork-minor"></use>
									<use class="fr-artwork-major" href="{{ asset('artwork/pictograms/buildings/city-hall.svg') }}#artwork-major"></use>
								</svg>
							</div>
						</div>

					</div>
					<!-- fin .fr-tile -->

				</div>
				<!-- fin .fr-col -->

				<div class="fr-col-sm-12 fr-col-md-7 fr-col-lg-7 fr-col-xl-8 custom-card-container">

					<h3 class="fr-h4 center">Votre clé unique</h3>

					<p>
						Comme indiqué en préambulle, votre vote a été enregistré de manière anonyme et il est impossible de faire le lien entre le registre des votants et leur vote respectif.
					</p>

					<p>
						Impossible? Pas tout à fait.
						<br>
						La clé unique ci-dessous est l'unique moyen de vérifier que votre vote n'a pas été altéré. Vous êtes seul à la connaître. Dès lors que vous quitterez cette page, y compris en raffraichissant la page,
						<span class="bold">elle sera définitivement détruite et ne pourra pas être récupérée</span>.
					</p>

					<p>
						En conséquent, révélez la clé en ayant pris soin de vous trouver à l'abris des regards indiscrets.
						<br>
						Assurez-vous de la conserver en lieu sûr.
					</p>

					<p>

						<div class="fr-input-group" id="secret-reveal-group">
							<label class="fr-label" for="secret-reveal">
								Votre clé unique
							</label>
							<div class="fr-input-wrap fr-input-wrap--action">
								<input class="fr-input" value="{{ secret }}" aria-describedby="secret-reveal-messages" id="secret-reveal" type="password">
								<button type="button" id="secret-reveal--btn" title="Révéler" class="fr-btn fr-icon-eye-line fr-btn--secondary">Révéler</button>
							</div>
							<div class="fr-messages-group" id="secret-reveal-messages" aria-live="polite"></div>
						</div>

					</p>

					<p class="fr-mt-4w">
						Pour vérifier l'intégrité de votre vote, copier la clé, puis rendez-vous sur
						<a href="{{ path('app_verify') }}" class="fr-link">cette page</a>.
					</p>
					<!-- fin .fr-col -->

				{% else %}

					<div class="fr-notice fr-notice--info">
						<div class="fr-container">
							<div class="fr-notice__body">
								<p>
									<span class="fr-notice__title">Aucune élection n'a été trouvée avec les caractéristiques demandées.</span>
									<a href="{{ path('app_election_dashboard') }}" target="_self" class="fr-notice__link">Accédez à cette page depuis le tableau de bord!</a>
								</p>
							</div>
						</div>
					</div>

				{% endif %}

			</div>

		</main>

		{% for candidat in election.candidats %}
			<dialog id="modal-{{ candidat.id }}" class="fr-modal" aria-labelledby="modal-{{ candidat.id }}-title" data-fr-concealing-backdrop="true">
				<div class="fr-container fr-container--fluid fr-container-md">
					<div class="fr-grid-row fr-grid-row--center">
						<div class="fr-col-12 fr-col-md-8 fr-col-lg-6">
							<div class="fr-modal__body">
								<div class="fr-modal__header">
									<button aria-controls="modal-{{ candidat.id }}" title="Fermer" type="button" id="button-5" class="fr-btn--close fr-btn">Fermer</button>
								</div>
								<div class="fr-modal__content">
									<h2 id="modal-{{ candidat.id }}-title" class="fr-modal__title">
										<span class="fr-icon-info-line fr-icon--lg" aria-hidden="true"></span>
										Confirmation de vote
									</h2>
									<p>
										Vous êtes sur le point de donner votre vote au candidat
										<br>
										<span class="bold fr-mb-2w">{{ candidat.displayname }}
											- nigend:
											{{ candidat.userId }}</span>.
										<br>
										Nous vous rappelons que vous ne pouvez voter qu'une seule fois, pour un seul candidat par élection, et que votre vote est définitif.
									</p>
								</div>
								<div class="fr-modal__footer">
									<div class="fr-btns-group fr-btns-group--right fr-btns-group--inline-reverse fr-btns-group--inline-lg fr-btns-group--icon-left">
										<a href="{{ path('app_confirm', { candidat_id: candidat.id}) }}" class="fr-btn fr-icon-checkbox-circle-line fr-btn--icon-left">Je confirme mon vote</a>
										<button aria-controls="modal-{{ candidat.id }}" class="fr-btn fr-icon-close-line fr-btn--icon-left fr-btn--secondary">Fermer</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</dialog>
		{% endfor %}
	{% endblock %}
